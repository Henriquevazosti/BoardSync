# BoardSync API# BoardSync API



API REST para o sistema BoardSync. Documenta√ß√£o completa dispon√≠vel no [README principal](../README.md).API REST para o sistema BoardSync. Documenta√ß√£o completa dispon√≠vel no [README principal](../README.md).



## üöÄ In√≠cio R√°pido## üöÄ In√≠cio R√°pido



```bash```bash

# Instalar depend√™ncias# Instalar depend√™ncias

npm installnpm install



# Executar com SQLite (desenvolvimento)# Executar com SQLite (desenvolvimento)

npm run dev:sqlitenpm run dev:sqlite



# Executar com PostgreSQL# Executar com PostgreSQL

npm run devnpm run dev

``````



## üìã Endpoints Principais## üìã Endpoints Principais



``````

POST   /api/v1/auth/login          # LoginPOST   /api/v1/auth/login          # Login

POST   /api/v1/auth/register       # Registro  POST   /api/v1/auth/register       # Registro  

GET    /api/v1/workspaces          # Listar workspacesGET    /api/v1/workspaces          # Listar workspaces

GET    /api/v1/boards/:id          # Obter boardGET    /api/v1/boards/:id          # Obter board

POST   /api/v1/cards               # Criar cardPOST   /api/v1/cards               # Criar card

PUT    /api/v1/cards/:id           # Atualizar cardPUT    /api/v1/cards/:id           # Atualizar card

``````



## üß™ Testes## üß™ Testes



Use a collection Postman inclu√≠da:Use a collection Postman inclu√≠da:

- `BoardSync-API-Collection.postman_collection.json`- `BoardSync-API-Collection.postman_collection.json`

- `BoardSync-API-Environment.postman_environment.json`- `BoardSync-API-Environment.postman_environment.json`



## ‚öôÔ∏è Configura√ß√£o## ‚öôÔ∏è Configura√ß√£o



Veja o arquivo [SETUP.md](SETUP.md) para op√ß√µes de configura√ß√£o detalhadas.Veja o arquivo [SETUP.md](SETUP.md) para op√ß√µes de configura√ß√£o detalhadas.



------



Para documenta√ß√£o completa, consulte o [README principal](../README.md).Para documenta√ß√£o completa, consulte o [README principal](../README.md).
- [WebSocket](#websocket)
- [Tratamento de Erros](#tratamento-de-erros)

## üöÄ Configura√ß√£o

### Pr√©-requisitos

- Node.js 18+
- PostgreSQL 14+
- Redis (opcional, para cache)

### Instala√ß√£o

1. Instalar depend√™ncias:
```bash
cd api
npm install
```

2. Configurar vari√°veis de ambiente:
```bash
cp .env.example .env
```

3. Configurar banco de dados:
```bash
npm run db:setup
```

4. Iniciar servidor:
```bash
# Desenvolvimento
npm run dev

# Produ√ß√£o
npm start
```

### Vari√°veis de Ambiente

```env
# Servidor
PORT=3001
NODE_ENV=development

# Banco de dados
DB_HOST=localhost
DB_PORT=5432
DB_NAME=boardsync
DB_USER=postgres
DB_PASSWORD=sua_senha

# JWT
JWT_SECRET=sua_chave_secreta_jwt
JWT_EXPIRES_IN=7d

# CORS
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Logs
LOG_LEVEL=info

# Socket.IO
SOCKET_CORS_ORIGIN=http://localhost:3000
```

## üîê Autentica√ß√£o

A API utiliza autentica√ß√£o JWT (JSON Web Tokens). Todas as rotas protegidas requerem o header:

```
Authorization: Bearer <token>
```

### Obter Token

```http
POST /api/v1/auth/login
Content-Type: application/json

{
  "email": "usuario@exemplo.com",
  "password": "senha123"
}
```

**Resposta:**
```json
{
  "message": "Login realizado com sucesso",
  "user": {
    "id": "uuid",
    "email": "usuario@exemplo.com",
    "name": "Nome do Usu√°rio",
    "role": "member"
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

## üìö Endpoints

### Autentica√ß√£o

| M√©todo | Endpoint | Descri√ß√£o | Autentica√ß√£o |
|--------|----------|-----------|--------------|
| POST | `/api/v1/auth/register` | Registrar usu√°rio | ‚ùå |
| POST | `/api/v1/auth/login` | Login | ‚ùå |
| GET | `/api/v1/auth/verify` | Verificar token | ‚úÖ |
| POST | `/api/v1/auth/logout` | Logout | ‚úÖ |
| POST | `/api/v1/auth/forgot-password` | Esqueceu senha | ‚ùå |
| POST | `/api/v1/auth/reset-password` | Redefinir senha | ‚ùå |

### Workspaces

| M√©todo | Endpoint | Descri√ß√£o | Autentica√ß√£o |
|--------|----------|-----------|--------------|
| GET | `/api/v1/workspaces` | Listar workspaces | ‚úÖ |
| GET | `/api/v1/workspaces/:id` | Buscar workspace | ‚úÖ |
| POST | `/api/v1/workspaces` | Criar workspace | ‚úÖ |
| PUT | `/api/v1/workspaces/:id` | Atualizar workspace | ‚úÖ |
| DELETE | `/api/v1/workspaces/:id` | Deletar workspace | ‚úÖ |
| POST | `/api/v1/workspaces/:id/members` | Adicionar membro | ‚úÖ |
| DELETE | `/api/v1/workspaces/:id/members/:userId` | Remover membro | ‚úÖ |

### Boards

| M√©todo | Endpoint | Descri√ß√£o | Autentica√ß√£o |
|--------|----------|-----------|--------------|
| GET | `/api/v1/boards/workspace/:workspaceId` | Listar boards | ‚úÖ |
| GET | `/api/v1/boards/:id` | Buscar board completo | ‚úÖ |
| POST | `/api/v1/boards/workspace/:workspaceId` | Criar board | ‚úÖ |
| PUT | `/api/v1/boards/:id` | Atualizar board | ‚úÖ |
| DELETE | `/api/v1/boards/:id` | Deletar board | ‚úÖ |

### Cards

| M√©todo | Endpoint | Descri√ß√£o | Autentica√ß√£o |
|--------|----------|-----------|--------------|
| GET | `/api/v1/cards/list/:listId` | Listar cards | ‚úÖ |
| GET | `/api/v1/cards/:id` | Buscar card completo | ‚úÖ |
| POST | `/api/v1/cards/list/:listId` | Criar card | ‚úÖ |
| PUT | `/api/v1/cards/:id` | Atualizar card | ‚úÖ |
| POST | `/api/v1/cards/:id/move` | Mover card | ‚úÖ |
| POST | `/api/v1/cards/:id/assign` | Atribuir usu√°rios | ‚úÖ |
| DELETE | `/api/v1/cards/:id` | Deletar card | ‚úÖ |

### Uploads

| M√©todo | Endpoint | Descri√ß√£o | Autentica√ß√£o |
|--------|----------|-----------|--------------|
| POST | `/api/v1/upload/image` | Upload de imagem | ‚úÖ |
| POST | `/api/v1/upload/file` | Upload de arquivo | ‚úÖ |

## üìä Modelos de Dados

### Workspace

```json
{
  "id": "uuid",
  "name": "Nome do Workspace",
  "description": "Descri√ß√£o opcional",
  "color": "#0052cc",
  "visibility": "private",
  "created_by": "uuid",
  "created_at": "2025-07-11T10:00:00Z",
  "updated_at": "2025-07-11T10:00:00Z"
}
```

### Board

```json
{
  "id": "uuid",
  "workspace_id": "uuid",
  "name": "Nome do Board",
  "description": "Descri√ß√£o opcional",
  "background_color": "#ffffff",
  "background_image": "url_da_imagem",
  "created_by": "uuid",
  "created_at": "2025-07-11T10:00:00Z",
  "updated_at": "2025-07-11T10:00:00Z",
  "lists": [
    {
      "id": "uuid",
      "name": "Nome da Lista",
      "position": 1,
      "cards": [...]
    }
  ]
}
```

### Card

```json
{
  "id": "uuid",
  "list_id": "uuid",
  "title": "T√≠tulo do Card",
  "description": "Descri√ß√£o do card",
  "position": 1,
  "priority": "media",
  "category": "tarefa",
  "is_blocked": false,
  "block_reason": "",
  "due_date": "2025-07-20T23:59:59Z",
  "start_date": "2025-07-11T08:00:00Z",
  "estimated_hours": 8.5,
  "actual_hours": 6.0,
  "created_by": "uuid",
  "completed_at": null,
  "created_at": "2025-07-11T10:00:00Z",
  "updated_at": "2025-07-11T10:00:00Z",
  "assignees": [
    {
      "id": "uuid",
      "name": "Nome do Usu√°rio",
      "email": "usuario@exemplo.com",
      "avatar": "üë§"
    }
  ],
  "labels": [
    {
      "id": "uuid",
      "name": "Frontend",
      "color": "#0052cc",
      "bg_color": "#e6f3ff"
    }
  ],
  "comment_count": 3,
  "attachment_count": 1,
  "subtask_count": 0
}
```

## üîÑ WebSocket

A API suporta comunica√ß√£o em tempo real via Socket.IO.

### Conex√£o

```javascript
import io from 'socket.io-client';

const socket = io('http://localhost:3001', {
  auth: {
    token: 'seu_jwt_token'
  }
});
```

### Eventos

#### Entrar em salas

```javascript
// Entrar em workspace
socket.emit('join-workspace', 'workspace-id');

// Entrar em board
socket.emit('join-board', 'board-id');
```

#### Eventos de cards

```javascript
// Card movido
socket.emit('card-moved', {
  cardId: 'card-id',
  boardId: 'board-id',
  oldListId: 'old-list-id',
  newListId: 'new-list-id',
  position: 2
});

// Escutar movimenta√ß√µes
socket.on('card-moved', (data) => {
  console.log('Card movido:', data);
});

// Card atualizado
socket.on('card-updated', (data) => {
  console.log('Card atualizado:', data);
});
```

#### Chat em tempo real

```javascript
// Enviar mensagem
socket.emit('chat-message', {
  workspaceId: 'workspace-id',
  message: 'Ol√° equipe!',
  userId: 'user-id'
});

// Receber mensagens
socket.on('chat-message', (data) => {
  console.log('Nova mensagem:', data);
});
```

## ‚ö†Ô∏è Tratamento de Erros

A API retorna erros em formato JSON consistente:

```json
{
  "error": "Mensagem de erro leg√≠vel",
  "details": [
    {
      "field": "email",
      "message": "Email deve ser v√°lido"
    }
  ]
}
```

### C√≥digos de Status HTTP

- `200` - Sucesso
- `201` - Criado com sucesso
- `400` - Dados inv√°lidos
- `401` - N√£o autenticado
- `403` - Permiss√£o negada
- `404` - N√£o encontrado
- `409` - Conflito (dados duplicados)
- `429` - Muitas requisi√ß√µes
- `500` - Erro interno do servidor

### Rate Limiting

A API implementa rate limiting para prevenir abuso:

- **Limite**: 100 requisi√ß√µes por IP a cada 15 minutos
- **Headers de resposta**:
  - `X-RateLimit-Limit`: Limite m√°ximo
  - `X-RateLimit-Remaining`: Requisi√ß√µes restantes
  - `X-RateLimit-Reset`: Timestamp do reset

## üìù Logs

Os logs s√£o salvos em:
- `logs/combined.log` - Todos os logs
- `logs/error.log` - Apenas erros

N√≠veis de log dispon√≠veis:
- `error` - Apenas erros
- `warn` - Avisos e erros
- `info` - Informa√ß√µes, avisos e erros (padr√£o)
- `debug` - Todos os logs

## üß™ Testes

```bash
# Executar todos os testes
npm test

# Executar testes em watch mode
npm run test:watch

# Executar testes com coverage
npm run test:coverage
```

## üìà Monitoramento

### Health Check

```http
GET /health
```

**Resposta:**
```json
{
  "status": "OK",
  "timestamp": "2025-07-11T10:00:00Z",
  "version": "v1"
}
```

### M√©tricas

- **Uptime**: Tempo de funcionamento do servidor
- **Memory**: Uso de mem√≥ria
- **Database**: Status da conex√£o com banco
- **Redis**: Status do cache (se configurado)

## üîß Desenvolvimento

### Estrutura do Projeto

```
api/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/         # Configura√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ controllers/    # Controladores
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/    # Middlewares
‚îÇ   ‚îú‚îÄ‚îÄ routes/         # Rotas
‚îÇ   ‚îî‚îÄ‚îÄ server.js       # Servidor principal
‚îú‚îÄ‚îÄ logs/               # Arquivos de log
‚îú‚îÄ‚îÄ uploads/            # Arquivos enviados
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

### Scripts Dispon√≠veis

```json
{
  "dev": "nodemon src/server.js",
  "start": "node src/server.js",
  "test": "jest",
  "migrate": "knex migrate:latest",
  "seed": "knex seed:run",
  "db:setup": "node setup-database.js"
}
```

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo LICENSE para mais detalhes.
